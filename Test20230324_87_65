package Test;

import java.io.IOException;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;

/**
 * ç®¡é“æµæµ‹è¯•ï¼šä¸€ä¸ªçº¿ç¨‹å†™å…¥ï¼Œä¸€ä¸ªçº¿ç¨‹è¯»å–
 * ä½œç”¨ï¼šç”¨äºçº¿ç¨‹ä¹‹é—´çš„æ•°æ®é€šè®¯
 * @author yangzixi
 *
 */
public class Test65_PipedInputStream {
	
	public static void main(String[] args) {
		PipedInputStream pin = new PipedInputStream();
		PipedOutputStream pout = new PipedOutputStream();
		try {
			pin.connect(pout);//ä¸¤ä¸ªç®¡é“è¿›è¡Œè¿æ¥ connectè¿æ¥
		} catch (IOException e) {
			e.printStackTrace();
		}//è¾“å…¥æµä¸è¾“å‡ºæµè¿æ¥
		
		ReadThread readTh = new ReadThread(pin);
		WriteThread writeTh = new WriteThread(pout);
		new Thread(readTh).start();
		new Thread(writeTh).start();

	}

}
//è¯»å–æ•°æ®çš„çº¿ç¨‹
class ReadThread implements Runnable{
		private PipedInputStream pin;//è¾“å…¥ç®¡é“
		
		ReadThread(PipedInputStream pin){
			this.pin = pin;
		}
		public void run() {
			try {
				byte[] buf = new byte[1024];
				int len = pin.read(buf);//readé˜»å¡
				String s = new String(buf,0,len);
				System.out.println("è¯»åˆ°ï¼š"+s);
				pin.close();
			}catch(Exception e) {
				e.printStackTrace();
			}
		}
}
//å†™å…¥çº¿ç¨‹
class WriteThread implements Runnable{
	private PipedOutputStream pout;//è¾“å‡ºç®¡é“
	
	public WriteThread(PipedOutputStream pout) {
		this.pout = pout;	
	}
	public void run() {
		try {
			pout.write("ä¸€åªä¿®ç‹—ğŸ¶".getBytes());//ç®¡é“è¾“å‡ºæµ
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}
